<html>
<head>
	<link href="https://use.fontawesome.com/releases/v5.15.1/css/all.css" rel="stylesheet"/>
	<link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700" rel="stylesheet" type="text/css"/>
	<link href="https://strahd-von-zarovich-the-first.github.io/themes/bundle.css" rel="stylesheet"/>
	<script src="https://bitwiseshiftleft.github.io/sjcl/sjcl.js"></script>
	<script>
	encrypted = ['{"iv":"trzt/Ii6IBm3Aatk8wF1jA==","v":1,"iter":10000,"ks":128,"ts":64,"mode":"ccm","adata":"","cipher":"aes","salt":"Ebe4sxyqPsw=","ct":"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"}'];
	function attemptDecrypt(field){
		output = null;
		for(const item of encrypted){
			try {
				output = sjcl.json.decode(sjcl.decrypt(field.value, item));
				break;
				
			} catch (error) {continue;}
		}
		if(output){
			document.getElementById("maincontent").innerHTML = output["maincontent"];
			document.getElementById("extracontent").innerHTML = output["extracontent"];
		}
		else{
			generateFakeText(field);
		}
	}
	var wordLengths = [1,2,2,3,3,4,4,5,5,5,5,5,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,12,12,12,12,12,12,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14];
	
	var sentenceLengths = [4,5,5,6,6,7,7,9,10,11,11,12,13,14];
	
	var paragraphLengths = [1,1,1,1,1,2,2,2,3,3,4];
	
	var letters = "abcdefghijklmnopqrstuvwxyz,."
	
	function mulberry32(a) {
		return function() {
		  var t = a += 0x6D2B79F5;
		  t = Math.imul(t ^ t >>> 15, t | 1);
		  t ^= t + Math.imul(t ^ t >>> 7, t | 61);
		  return ((t ^ t >>> 14) >>> 0) / 4294967296;
		}
	}	
	
	function TSH(s){
		for(var i=0,h=9;i<s.length;)
			h=Math.imul(h^s.charCodeAt(i++),9**9);
		return h^h>>>9;
	}
	
	function eleFrom(arr, rng){
		return arr[Math.floor(arr.length*(rng()))]
	}
	
	function horizontalFit(parent, child){
	 var parentRect = parent.getBoundingClientRect();
    var childRect = child.getBoundingClientRect();

    return parentRect.left <= childRect.left && parentRect.right >= childRect.right;
}
	
	async function generateFakeText(field){
	
		document.getElementById("extracontent").innerHTML = "";
		
		page = document.getElementById("p3")
		mc = document.getElementById("maincontent")
		mc.innerHTML = "";
		rng = mulberry32(TSH(field.value));
		
		while(horizontalFit(page, mc)){
			output = await generateFakeParagraph(rng, mc)
		}
		mc.innerHTML = mc.innerHTML.slice(0, - output.length);
	}
	
	async function generateFakeParagraph(rng,mc){
	
		output = "<p class=\"fake\">";
		for(let s_c = 0, l_s = eleFrom(paragraphLengths,rng); s_c < l_s; s_c++){
			for(let w_c = 0, l_w = eleFrom(sentenceLengths,rng); w_c < l_w; w_c++){
				for(let c_c = 0, l_c = eleFrom(wordLengths,rng); c_c < l_c; c_c++){
					output += eleFrom(letters, rng);
				}
				output += " ";
			}
			output += ". ";
		}
		output += "</p>";
		mc.innerHTML += output;
		return output;
		}
	</script>
	<base target="_blank"/>
</head>
<body>
<div>
<div class="frame-content">
	<div class="brewRenderer">
		<div class="popups"></div>
		<link href="https://strahd-von-zarovich-the-first.github.io/themes/5ePhbLegacy.style.css" rel="stylesheet"/>
		<div class="pages">
			<div class="phb page" id="p1" style="padding-top:90.0mm">
				<style>
				  .phb#p1{ text-align:center;}
				  .phb#p1:after{ display:none; }
				</style>
				<testscript src="https://homebrewery.naturalcrit.com/homebrew/bundle.js"></script>
				
					<img src="https://strahd-von-zarovich-the-first.github.io/cover.png" style="position:absolute; top:0px; right:00px; width:100%">
					
					<p></p>
				<h1 id="diary-title"><span style="box-shadow: 0px 0px 50px 50px rgba(255,255,255,0.5); background-color:rgba(255,255,255,0.5)">The Diary of Strahd Von Zarovich</span></h1>
				
				<p></p>
				<div style="margin-top:25px"></div>
				<p></p>
				<p></p>
				<div class="wide">
					<p></p>
					<h5 id="diary-subtitle"><span style="box-shadow: 0px -10px 40px 40px rgba(255,255,255,0.3); background-color:rgba(255,255,255,0.3)">A hidden tale of love, horror, and regret.</span></h5>
				 </div>
			</div>
			<div class="phb page" id="p2"><img src="https://strahd-von-zarovich-the-first.github.io/page i.png" style="position:absolute; top:0px; right:00px; width:100%"><p></p><div class="pageNumber"> <p>i</p></div></div>
			
			<div class="phb page" id="p3">
			
				<div class="pageNumber"> <p>1</p></div>
				<div class="wide"> <h3 id="speak-into-the-book-and-your-words-shall-bring-answers-">Speak into the book, and your words shall bring answers.</h3>
					<style>
					.brewRenderer{
						background-color:#113;
					}
						.answers{
						  width: 100%;
						  padding: 12px 20px;
						  margin: 8px 0;
						  box-sizing: border-box;
							background-color: rgba(255,255,255,0.1);
							border:5px solid rgba(0,0,0,0.3);
							border-radius:10px;
					}
						.maincontent{
							font-size:16px;
							-webkit-touch-callout: none;
							-webkit-user-select: none;
							-khtml-user-select: none;
							-moz-user-select: none;
							-ms-user-select: none;
							user-select: none;
						}
						.extracontent{
							font-size:16px;
							-webkit-touch-callout: none;
							-webkit-user-select: none;
							-khtml-user-select: none;
							-moz-user-select: none;
							-ms-user-select: none;
							user-select: none;

						}
						.fake{opacity:0.5;}
					</style>

					<p><input type="text" onkeyup="attemptDecrypt(this)" class="answers">
					</p>
				</div>
				<p></p>
				<div class="maincontent" id="maincontent">

				</div>
				<p></p>
			</div>
			<div id="extracontent"></div>
		</div>
	</div>
</div>
</div>
</body>
</html>